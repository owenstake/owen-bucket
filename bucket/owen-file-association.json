{
    "version": "1.0",
    "description": "Set xiaohe shuangpin for microsoft pinyin",
    "homepage": "https://github.com/owenstake/owen-bucket",
    "depends": ["draw.io", "vim-tux", "typora-1.9.5","7zip",
                "autohotkey1.1", "foxit-pdf-reader-2023"],
    "url": "https://github.com/owenstake/owen-bucket/releases/download/v1.0.0/Empty.txt",
    "hash" : "2E1CFA82B035C26CBBBDAE632CEA070514EB8B773F616AAEAF668E2F0BE8F10D",
    "installer": {
        "script": [
            ". ../script/lib.ps1                        ",
            "''                                         ",
            "Associate-ScoopAppWithExtension   '.ahk'              'autohotkey1.1'        ",
            "# Associate-ScoopAppWithExtension '.md'               'vscode'               ",
            "Associate-ScoopAppWithExtension   '.md'               'typora-1.9.5'         ",
            "Associate-ScoopAppWithExtension   '.pdf'              'foxit-pdf-reader-2023'",
            "Associate-ScoopAppWithExtension   '.drawio,.png,.svg' 'draw.io'              ",
            "Associate-ScoopAppWithExtension   '.mp4,mkv'          'vlc'                  ",
            "$7zFileType = '.7z,.rar,.zip,.tgz,.gz,.xz'                                   ",
            "Associate-ScoopAppWithExtension   \"$7zFileType\"     '7zip'                 ",

            "'##############################################'  ",
            "'##### Right Click Context Menu ###############'  ",
            "'##############################################'  ",
            "# Set right click menu                            ",
            "Add-RightClickScoopItemForAll 'vscode'            ",
            "Add-RightClickScoopItemForAll 'vim-tux'           ",
            "Add-RightClickScoopItemForAll '7zip'              ",
            "# powershell.exe is better for debug than cmd.exe ",
            "$drawioExe = \"$(scoop prefix draw.io)/$(GetExeForScoop draw.io)\" ",
            "Add-RightClickItemWithCommand '.svg,.png'                 `",
            "                              'Edit-By-Drawio'            `",
            "                              \"$drawioExe\"              `",
            "                              \"$drawioExe\"   `\"%1`\" \"         ",
            "Add-RightClickItemWithCommand 'Directory\\Background'              ",
            "                              '粘贴快捷方式(环境变量)'             ",
            "                              ''                                   ",
            "                              \"powershell -c `\"Paste-FileAsShortcut `'%W`'`\"",
            "$7zIcon = \"$(scoop prefix 7zip)/7zG.exe\"                 ",
            "Add-RightClickItemWithCommand   'AllFileSystemObjects'      `",
            "                                'Zip'                       `",
            "                                \"$7zIcon\"                 `",
            "                                \"cmd /c singleinstance.exe `\"%1`\" powershell -c Compress-Interactive `$files --si-timeout 400\"",
            "Add-RightClickItemWithCommand   \"$7zFileType\"           `",
            "                                'Expand'                  `",
            "                                \"$7zIcon\"               `",
            "                                \"powershell -c `\"Expand-by-7zip `'%1`' `'%W`'`\" \"",
            "'Add new file item'",
            "$drawioFile    = (Get-ChildItem $Env:OwenInstallDir -Recurse 'blank.drawio'    )[0].FullName",
            "$drawioPngFile = (Get-ChildItem $Env:OwenInstallDir -Recurse 'blank.drawio.png')[0].FullName",
            "$drawioSvgFile = (Get-ChildItem $Env:OwenInstallDir -Recurse 'blank.drawio.svg')[0].FullName",
            "Add-ShellNewWithTemplate $drawioPngFile              ",
            "Add-ShellNewWithTemplate $drawioSvgFile              ",
            "# Add-ShellNewWithTemplate  '.drawio'  $drawioFile   ",
            ""
        ]
    },
    "uninstaller": {
        "script": [
            ". ../script/lib.ps1                                                            ",
            "''                                                                             ",
            "'Remove all scoop app info and its extension association in windows registry.' ",
            "Remove-AllScoopAppInRegistry                                                   ",
            ""
        ]
    }
}
